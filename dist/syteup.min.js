"use strict";function numberWithCommas(x){return x.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")}function formatModuleName(module){return module.replace(/_(.)/g,function(match,p1){return p1.toUpperCase()})}function syncGet(url,success,headers,failure){var xhr=new XMLHttpRequest;if(xhr.open("GET",url,!1),xhr.onload=function(){return 200!==this.status?void(failure&&failure()):void success(JSON.parse(this.responseText))},xhr.onerror=function(){failure&&failure()},headers)for(var header in headers)headers.hasOwnProperty(header)&&xhr.setRequestHeader(header,headers[header]);xhr.send()}function asyncGet(url,headers,jsonp){return new Promise(function(resolve,reject){$.ajax({url:url,headers:headers,beforeSend:function(xhr){if(headers)for(var H in headers)headers.hasOwnProperty(H)&&xhr.setRequestHeader(H,headers[H])},jsonp:jsonp,contentType:"application/json; charset=utf-8",type:"GET",dataType:"jsonp",async:!1,success:function(res){"meta"in res&&2===Object.keys(res).length&&("data"in res?res=res.data:"response"in res&&(res=res.response)),resolve(res)},error:function(xhr,status){reject(status)}})})}function asyncText(url,headers){return new Promise(function(resolve,reject){var xhr=new XMLHttpRequest;if(xhr.open("GET",url,!1),xhr.onload=function(){return 200!==this.status?void reject(this.status):void resolve(this.responseText)},xhr.onerror=function(){reject()},headers)for(var header in headers)headers.hasOwnProperty(header)&&xhr.setRequestHeader(header,headers[header]);xhr.send()})}function setupBlog(settings){var postOffset,postsOpts;return $(document).on("click",".post-link",function(){this.dataset.id&&(postsOpts={id:this.dataset.id},fetchBlogPosts(0,settings.blogs_settings[settings.blog_platform],settings.blog_platform,postsOpts)),postOffset=0}),$(document).on("click",".tag-link",function(){this.textContent&&(window.reachedEnd=!1,postsOpts={tag:this.textContent},fetchBlogPosts(0,settings.blogs_settings[settings.blog_platform],settings.blog_platform,postsOpts).then(function(offset){postOffset=offset}))}),$("#home-item-link").on("click",function(){"#!"===location.hash.substr(0,2)&&(location.hash="",postsOpts=void 0,window.reachedEnd=!1,fetchBlogPosts(0,settings.blogs_settings[settings.blog_platform],settings.blog_platform).then(function(offset){postOffset=offset}))}),window.sharethis_enabled=settings.blogs_settings.plugins.sharethis||!1,settings.blogs_settings.plugins.disqus&&window.disqusPlugin.setup(settings.plugins_settings.disqus),window.reachedEnd=!1,"#!post/"===location.hash.substr(0,7)?postsOpts={id:location.hash.slice(7).split("#")[0]}:"#!tag/"===location.hash.substr(0,6)&&(postsOpts={tag:location.hash.slice(6).split("#")[0]}),fetchBlogPosts(0,settings.blogs_settings[settings.blog_platform],settings.blog_platform,postsOpts).then(function(offset){postOffset=offset;var resultsLoaded=!1,scrollWait=!1,scrollWaitDur=250;if($(window).scroll(function(){!window.reachedEnd&&!resultsLoaded&&!scrollWait&&postOffset&&$(window).scrollTop()+$(window).height()>$(document).height()/1.2&&(resultsLoaded=!0,scrollWait=!0,fetchBlogPosts(postOffset,settings.blogs_settings[settings.blog_platform],settings.blog_platform,postsOpts).then(function(offset){postOffset=offset,scrollWait=!1}),setTimeout(function(){scrollWait=!1},scrollWaitDur)),resultsLoaded&&$(window).scrollTop()+$(window).height()<$(document).height()/1.2&&(resultsLoaded=!1)}),window.sharethis_enabled){var jsfile=document.createElement("script");jsfile.src="http://w.sharethis.com/button/buttons.js",jsfile.type="text/javascript",document.body.appendChild(jsfile),stLight.options({publisher:settings.plugins_settings.sharethis.publisher_key})}return Promise.resolve()})}function setupBlogHeaderScroll(){if(!window.isMobileView){$(".blog-section article hgroup h3 a").click(function(e){this.hash&&($("html, body").stop().animate({scrollTop:$(this.hash).offset().top},500,"linear"),e.preventDefault())});var dateHeight=$("#blog-posts article hgroup h3 a")[0].scrollHeight;$(window).scroll(function(){window.scrollY;$("#blog-posts article").each(function(){this.className=window.scrollY<this.offsetTop?"":window.scrollY>this.offsetTop+this.scrollHeight-dateHeight?"passed":"current"})})}}function renderBlogPosts(posts,clearPosts){0===posts.length&&(window.reachedEnd=!0),Promise.all([asyncText("templates/blog-post-text.html"),asyncText("templates/blog-post-photo.html"),asyncText("templates/blog-post-link.html"),asyncText("templates/blog-post-video.html"),asyncText("templates/blog-post-audio.html"),asyncText("templates/blog-post-quote.html")]).then(function(res){var text_template=Handlebars.compile(res[0]),photo_template=Handlebars.compile(res[1]),link_template=Handlebars.compile(res[2]),video_template=Handlebars.compile(res[3]),audio_template=Handlebars.compile(res[4]),quote_template=Handlebars.compile(res[5]);$(".loading").remove(),clearPosts&&$("#blog-posts").empty(),posts=posts.forEach(function(p){if(p.formated_date=moment.utc(p.date,"YYYY-MM-DD HH:mm:ss").local().format("MMMM DD, YYYY"),window.disqus_enabled&&(p.disqus_enabled=!0),p.disqus_just_count=window.disqus_just_count,"text"===p.type){var idx=p.body.indexOf("<!-- more -->");idx>0&&(p.body=p.body.substring(0,idx),p.show_more=!0),$("#blog-posts").append(text_template(p))}else"photo"===p.type?$("#blog-posts").append(photo_template(p)):"link"===p.type?$("#blog-posts").append(link_template(p)):"video"===p.type?$("#blog-posts").append(video_template(p)):"audio"===p.type?$("#blog-posts").append(audio_template(p)):"quote"===p.type&&$("#blog-posts").append(quote_template(p))}),prettyPrint(),setTimeout(setupBlogHeaderScroll,1e3),adjustSelection("home"),document.body.dispatchEvent(new CustomEvent("blog-post-loaded"))})}function fetchBlogPosts(offset,settings,platform,posts_options){posts_options&&posts_options.id&&(window.reachedEnd=!0);var $blog=window[formatModuleName(platform)+"Blog"];if(!$blog)return Promise.reject(MODULE_NOT_FOUND);var posts;return posts=posts_options&&posts_options.id?$blog.fetchPost(settings,posts_options.id):posts_options&&posts_options.tag?offset?$blog.fetchTagMore(settings,posts_options.tag):$blog.fetchTag(settings,posts_options.tag):offset?$blog.fetchMore(settings):$blog.fetch(settings),posts.then(function(data){return data&&0!==data.length?(renderBlogPosts(data,posts_options&&posts_options.id||!offset),Promise.resolve(!0)):Promise.resolve(!1)}).catch(function(){return Promise.resolve(!1)})}function setupLinks(settings){allComponents=Object.keys(settings.services),allComponents.forEach(function(service){settings.services[service]&&enabledServices.push(service)}),"object"==typeof settings.fields.contact&&(enabledServices.push("syteup_contact"),settings.services_settings.syteup_contact=settings.fields.contact,settings.services_settings.syteup_contact.url="mailto:"+settings.fields.contact.email);var main_nav=document.getElementsByClassName("main-nav")[0];main_nav.innerHTML="",settings.blog_platform.length&&addLinkItem(main_nav,"/","home-item-link","Home");var i;for(i=0;i<enabledServices.length;i++){var text,service=enabledServices[i],$service=window[formatModuleName(service)+"Service"];text=$service?$service.displayName:service[0].toUpperCase()+service.slice(1),addLinkItem(main_nav,settings.services_settings[service].url,service+"-item-link",text)}"string"==typeof settings.fields.contact&&addLinkItem(main_nav,"mailto:"+settings.fields.contact+"?subject=Hello","contact-item-link","Contact"),linkClickHandler(settings)}function addLinkItem(main_nav,href,id,text){var li,link;li=document.createElement("li"),link=document.createElement("a"),link.href=href,link.id=id,link.textContent=text,li.appendChild(link),main_nav.appendChild(li)}function linkClickHandler(settings){$(".main-nav a").click(function(e){if(2!==e.which&&(e.preventDefault(),e.stopPropagation(),this.href!==$url)){if($url=this.href,"home-item-link"===this.id)return void adjustSelection("home");var i;for(i=0;i<enabledServices.length;i++){var service=enabledServices[i];if(this.id===service+"-item-link")return void adjustSelection(service,setupService.bind(this,service,$url,this,settings.services_settings[service]))}window.location=this.href}})}function adjustSelection(component,callback){var transition,$currProfileEl;"home"!==currSelection?($currProfileEl=$("#"+currSelection+"-profile"),transition=$.support.transition&&$currProfileEl.hasClass("fade"),$currProfileEl.modal("hide"),callback&&(transition?$currProfileEl.one($.support.transition.end,callback):callback())):callback&&callback(),$(".main-nav").children("li").removeClass("sel"),$("#"+component+"-item-link").parent().addClass("sel"),"home"===component&&($url=null),window.currSelection=component}function setupPlugins(settings){return Promise.all(pluginsPromises(settings))}function pluginsPromises(settings){return Object.keys(settings.plugins).filter(function(plugin){return settings.plugins[plugin]}).map(function(plugin){return setupPlugin(plugin,settings.plugins_settings[plugin]).then(console.log.bind(console,"Plugin Setuped:",plugin)).catch(console.error.bind(console,"Plugin Not Found",plugin))})}function setupPlugin(plugin,settings){return new Promise(function(resolve,reject){var $plugin=window[formatModuleName(plugin)+"Plugin"];$plugin?($plugin.setup(settings),resolve()):reject(MODULE_NOT_FOUND)})}function setupService(service,url,el,settings){var href=el.href,$service=window[formatModuleName(service)+"Service"];if($("#"+service+"-profile").length>0)return void(window.location=href);if(!$service)return console.error("Service Not Found:",service),void(window.location=href);var spinner=new Spinner(spin_opts).spin();$("#"+service+"-item-link").append(spinner.el);var promises=[$service.fetch(settings),asyncText("templates/"+$service.template)];return $service.supportMore&&promises.push(asyncText("templates/"+$service.templateMore)),Promise.all(promises).then(function(results){var $modal,serviceData=results[0],view=results[1],viewMore=results[2];if(!serviceData||serviceData.error)return void(window.location=href);var template=Handlebars.compile(view);if(serviceData=$service.setup(serviceData,settings),!serviceData)return void(window.location=href);if($modal=$(template(serviceData)).modal().on("hidden.bs.modal",function(){$(this).remove(),currSelection===service&&adjustSelection("home")}),$service.supportMore){var moreTemplate=Handlebars.compile(viewMore);$modal.find("#load-more-data").click(function(){var spinnerMore=new Spinner(spin_opts).spin();$(this).append(spinnerMore.el),$service.fetchMore(settings).then(function(serviceMoreData){serviceMoreData=$service.setupMore(serviceMoreData,settings),$("."+service+" .profile-data").append(moreTemplate(serviceMoreData)),spinnerMore.stop()}).catch(function(error){error===NO_MORE_DATA&&$(this).remove(),spinnerMore.stop()})})}spinner.stop(),console.info("Service Setuped:",service)}).catch(function(){console.error("Service Not Setuped:",service)})}window.UNKNOWN_ERROR=-1,window.NO_MORE_DATA=-2,window.MODULE_NOT_FOUND=-3,window.spin_opts={lines:9,length:5,width:2,radius:4,rotate:9,color:"#4c4c4c",speed:1.5,trail:40,shadow:!1,hwaccel:!0,className:"spinner",zIndex:2e9,left:"90%"};var $url,allComponents=[],enabledServices=[];window.currSelection="home";var settings={},xhr=new XMLHttpRequest;xhr.open("GET","config.json",!0),xhr.overrideMimeType&&xhr.overrideMimeType("text/plain"),xhr.onload=function(){200!==this.status&&0!==this.status&&alert("FATAL! CAN'T LOAD CONFIG FILE"),settings=JSON.parse(this.responseText),document.getElementById("field-realname").textContent=settings.fields.realname,document.getElementById("field-description").textContent=settings.fields.description,document.getElementById("field-url").textContent=settings.fields.url,document.head.getElementsByTagName("title")[0].textContent=settings.fields.username+" ["+settings.fields.realname+"]",document.head.getElementsByTagName("meta")[0].content=settings.fields.realname+" : "+settings.fields.description,settings.services.flickr&&(window.flickr_id=settings.services_settings.flickr.id),settings.services.tent&&(window.tent_entity_uri=settings.services_settings.tent.entity_uri,window.tent_feed_uri=settings.services_settings.tent.feed_url),$(function(){new Promise(function(resolve){setupLinks(settings),resolve()}).then(setupBlog(settings)).then(setupPlugins(settings))})},xhr.send();var isMobileView=!1;if("undefined"!=typeof window.matchMedia){var mediaQuery=window.matchMedia("(max-width:799px)");mediaQuery.matches&&(isMobileView=!0)}$(function(){$("#mobile-nav-btn").click(function(){$(".main-section").toggleClass("nav-opened")})}),function(window){function setupGoogleAnalytics(settings){var ga=window.ga=window.ga||function(){ga.q=ga.q||[],ga.q.push(arguments)},link=document.createElement("script"),firstScript=document.getElementsByTagName("script")[0];link.async=!0,link.src="https://www.google-analytics.com/analytics.js",firstScript.parentNode.insertBefore(link,firstScript),"localhost"===window.location.host||"172.0.0.1"===window.location.host||""===window.location.host?ga("create",settings.tracking_id,{cookieDomain:"none"}):ga("create",settings.tracking_id,"auto"),ga("set","forceSSL",!0),ga("set","anonymizeIp",!0),ga("send","pageview",{title:"Syteup",page:"index.html"})}window.googleAnalyticsPlugin={setup:setupGoogleAnalytics}}(window),function(window){function setupRss(settings){var rss=document.createElement("link");rss.rel="alternate",rss.type="application/rss+xml",rss.title="RSS",rss.href=settings.url,document.head.appendChild(rss)}window.rssPlugin={setup:setupRss}}(window),function(window){function setupControlPanel(){var style=document.createElement("style");style.appendChild(document.createTextNode("")),document.head.appendChild(style),style.sheet.insertRule(".control-panel-btn { display: inline-block; margin: 5px;}",0),style.sheet.insertRule(".control-panel-btn a { line-height: 25px; padding: 5px; margin: 0; border: solid 1px;}",0),style.sheet.insertRule(".control-panel-btn a.clicked {background-color: green}",0),style.sheet.insertRule(".control-panel-btn a.unclicked {background-color: red}",0),$("body").bind("blog-post-loaded",function(){$("#control-panel")[0]&&($.each($(".main-nav li a"),function(i,e){$("#control-panel").append("<div class='control-panel-btn'><a class='clicked' data-id='"+e.id+"'>#"+e.id+"</a></div>")}),$(".control-panel-btn a").click(function(){var id=this.dataset.id;"clicked"===this.className?(this.className="unclicked",$("#"+id).parent().hide(300)):(this.className="clicked",$("#"+id).parent().show(300))}),$("#control-panel").removeAttr("id"))})}window.controlPanelPlugin={setup:setupControlPanel}}(window),function(window){function setup(settings){window.grtpAPI="https://grtp.co/v1/";var script=document.createElement("script");script.src="https://grtp.co/v1.js",script.dataset.gratipayUsername=settings.username;var par=document.getElementById("header-widgets");par.appendChild(script)}window.gratipayWidgetPlugin={setup:setup}}(window),function(window){function embedDisqus(settings){var type="embed";settings.just_count&&(type="count");var dsq=document.createElement("script");dsq.type="text/javascript",dsq.async=!0,dsq.src="http://"+settings.shortname+".disqus.com/"+type+".js",(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(dsq),$(document).on("click",".disqus_show_comments",function(){var old=$("#disqus_thread");old.length&&(old[0].className="disqus_show_comments",old[0].id="",old.append($("<a>Show Comments</a>"))),this.innerHTML="",this.className="disqus-thread",this.id="disqus_thread",$(this).append($("<a href='/post/"+this.dataset.id+"#disqus_thread' class='comments'></a>"));var data=this.dataset;DISQUS.reset({reload:!0,config:function(){this.page.identifier=data.id,this.page.url=window.location.origin+window.location.pathname+"#!post/"+data.id,this.language="en"}})})}function setupDisqus(settings){window.disqus_enabled=!0,window.disqus_just_count=settings.just_count,window.disqus_shortname=settings.shortname,$("body").bind("blog-post-loaded",function(){embedDisqus(settings)})}window.disqusPlugin={setup:setupDisqus}}(window),function(window){function setupGithub(githubData){return githubData.user.following=numberWithCommas(githubData.user.following),githubData.user.followers=numberWithCommas(githubData.user.followers),githubData}function fetchData(settings){var context={};return Promise.all([asyncGet(API_URL+"users/"+settings.client_id),asyncGet(API_URL+"users/"+settings.client_id+"/repos")]).then(function(res){return context.user=res[0],context.repos=res[1],context.repos.sort(function(r1,r2){return r1.updated_at<r2.updated_at}),Promise.resolve(context)})}var DISPLAY_NAME="Github",API_URL="https://api.github.com/";window.githubService={displayName:DISPLAY_NAME,template:"github.html",setup:setupGithub,fetch:fetchData}}(window),function(window){function setupFlickr(flickrData){return 0!==flickrData.items?(flickrData.title=flickrData.title.substring(13),$.each(flickrData.items,function(i,p){p.formated_date=moment.unix(Date.parse(p.date_taken)/1e3).fromNow()}),flickrData):void 0}function fetchData(settings){return asyncGet("http://api.flickr.com/services/feeds/photos_public.gne?id="+settings.client_id+"&format=json&lang=en-us",{},"jsoncallback")}var DISPLAY_NAME="Flickr";window.flickrService={displayName:DISPLAY_NAME,template:"flickr.html",setup:setupFlickr,fetch:fetchData}}(window),function(window){function setupSoundcloud(soundcloudData){return soundcloudData}function fetchData(settings){return Promise.all([asyncGet(API_URL+"users/"+settings.username+".json?client_id="+settings.client_id),asyncGet(API_URL+"users/"+settings.username+"/tracks.json?client_id="+settings.client_id)]).then(function(res){return{user_tracks:{show_artwork:settings.show_artwork,player_color:settings.player_color,tracks:res[1]},user_profile:res[0]}})}var DISPLAY_NAME="SoundCloud",API_URL="https://api.soundcloud.com/";window.soundcloudService={displayName:DISPLAY_NAME,template:"soundcloud.html",setup:setupSoundcloud,fetch:fetchData}}(window),function(window){function setupLastfm(lastfmData){return Handlebars.registerHelper("text",function(obj){try{return obj["#text"]}catch(err){return""}}),Handlebars.registerHelper("image_url",function(obj){try{return obj[0]["#text"]}catch(err){return""}}),Handlebars.registerHelper("avatar_url",function(obj){try{return obj[1]["#text"]}catch(err){return""}}),lastfmData.user_info.user.formatted_plays=numberWithCommas(lastfmData.user_info.user.playcount),lastfmData.user_info.user.formatted_playlists=numberWithCommas(lastfmData.user_info.user.playlists),lastfmData.user_info.user.formatted_register_date=moment.utc(lastfmData.user_info.user.registered["#text"],"YYYY-MM-DD HH:mm").format("MM/DD/YYYY"),$.each(lastfmData.recenttracks.recenttracks.track,function(i,t){var date;try{date=t.date["#text"]}catch(err){return t.formatted_date="Now Playing",!0}t.formatted_date=moment.utc(date,"DD MMM YYYY, HH:mm").fromNow()}),lastfmData}function fetchData(settings){return Promise.all([asyncGet(API_URL+"?method=user.getinfo&user="+settings.username+"&format=json&api_key="+settings.api_key),asyncGet(API_URL+"?method=user.getrecenttracks&user="+settings.username+"&format=json&api_key="+settings.api_key)]).then(function(res){return Promise.resolve({user_info:res[0],recenttracks:res[1]})})}var DISPLAY_NAME="Last.fm",API_URL="https://ws.audioscrobbler.com/2.0/";window.lastfmService={displayName:DISPLAY_NAME,template:"lastfm.html",setup:setupLastfm,fetch:fetchData}}(window),function(window){function setupStackoverflow(stackoverflowData){var user=stackoverflowData.user,badge_count=user.badge_counts.bronze+user.badge_counts.silver+user.badge_counts.gold;user.badge_count=badge_count,user.about_me=(user.about_me||"").replace(/(<([^>]+)>)/gi,"");var timeline=stackoverflowData.timeline;return $.each(timeline,function(i,t){t.creation_date=moment.unix(t.creation_date).fromNow(),"comment"===t.action&&(t.action="commented"),t.detail&&t.detail.length>140&&(t.detail=$.trim(t.detail).substring(0,140).split(" ").slice(0,-1).join(" ")+"...")}),{user:user,timeline:timeline}}function fetchData(settings){return Promise.all([asyncGet(API_URL+"users/"+settings.userid+"?site=stackoverflow&filter=!-*f(6q3e0kZX"),asyncGet(API_URL+"users/"+settings.userid+"/timeline?site=stackoverflow")]).then(function(res){return Promise.resolve({user:res[0].items[0],timeline:res[1].items})})}var DISPLAY_NAME="StackOverflow",API_URL="https://api.stackexchange.com/2.2/";window.stackoverflowService={displayName:DISPLAY_NAME,template:"stackoverflow.html",setup:setupStackoverflow,fetch:fetchData}}(window),function(window){function setupBitbucket(bitbucketData){return bitbucketData.user.followers=numberWithCommas(bitbucketData.user.followers),bitbucketData}function fetchData(settings){var context={};return Promise.all([asyncGet(API_URL+"users/"+settings.username+"?jsoncallback=mainRequest"),asyncGet(API_URL+"users/"+settings.username+"/followers?jsoncallback=followersRequest")]).then(function(res){return context=res[0],context.user.followers=res[1].count,context.user.public_repos=context.repositories.length,context.repositories.sort(function(r1,r2){return r1.utc_last_updated<r2.utc_last_updated}),settings.show_forks?Promise.all(context.repositories.map(function(repo){return asyncGet(API_URL+"repositories/"+settings.username+"/"+repo.slug+"?jsoncallback=forksRequest")})).then(function(forks){var i=0;return forks.forEach(function(fork){context.repositories[i++].forks_count=fork.forks_count}),Promise.resolve(context)}):Promise.resolve(context)})}var DISPLAY_NAME="Bitbucket",API_URL="https://api.bitbucket.org/1.0/";window.bitbucketService={displayName:DISPLAY_NAME,template:"bitbucket.html",setup:setupBitbucket,fetch:fetchData}}(window),function(window){function setupDribbble(dribbbleData){var user=dribbbleData.shots[0].player;return user.following_count=numberWithCommas(user.following_count),user.followers_count=numberWithCommas(user.followers_count),user.likes_count=numberWithCommas(user.likes_count),{user:user,shots:dribbbleData.shots}}function fetchData(settings){return asyncGet(API_URL+settings.username+"/shots")}var DISPLAY_NAME="Dribbble",API_URL="https://api.dribbble.com/players/";window.dribbbleService={displayName:DISPLAY_NAME,template:"dribbble.html",setup:setupDribbble,fetch:fetchData}}(window),function(window){function setupInstagram(instagramData){if(0!==instagramData.media){var user_counts=instagramData.user.counts;return user_counts.media=numberWithCommas(user_counts.media),user_counts.followed_by=numberWithCommas(user_counts.followed_by),user_counts.follows=numberWithCommas(user_counts.follows),$.each(instagramData.media,function(i,p){p.formated_date=moment.unix(parseInt(p.created_time)).fromNow()}),instagramData}}function setupInstagramMore(instagramData){return $.each(instagramData.media,function(i,p){p.formated_date=moment.unix(parseInt(p.created_time)).fromNow()}),instagramData}function fetchData(settings){return Promise.all([asyncGet(API_URL+"users/"+settings.user_id+"/?access_token="+settings.access_token),asyncGet(API_URL+"users/"+settings.user_id+"/media/recent/?access_token="+settings.access_token)]).then(function(res){return nextId=res[1].pagination.next_max_id,Promise.resolve({user:res[0],media:res[1].data,pagination:nextId})})}function fetchMore(settings){return nextId?asyncGet(API_URL+"users/"+settings.user_id+"/media/recent/?access_token="+settings.access_token+"&max_id="+nextId).then(function(res){return nextId=res.pagination.next_max_id,Promise.resolve({media:res.data,pagination:nextId})}):Promise.reject(NO_MORE_DATA)}var nextId,DISPLAY_NAME="Instagram",API_URL="https://api.instagram.com/v1/";window.instagramService={displayName:DISPLAY_NAME,template:"instagram.html",templateMore:"instagram-more.html",setup:setupInstagram,fetch:fetchData,supportMore:!0,fetchMore:fetchMore,setupMore:setupInstagramMore}}(window),function(window){function setupYoutube(youtubeData,settings){return youtubeData.message||0===youtubeData.activities.length?void 0:(youtubeData.statistics.url=settings.url,youtubeData.channel.url=settings.url,$.each(youtubeData.activities,function(i,t){t.publishedAt=moment.utc(t.publishedAt,"YYYY-MM-DD HH:mm:ss").fromNow(),t.img=t.thumbnails.default.url,"playlistItem"===t.type?t.type="add to playlist":"bulletin"===t.type&&(t.type="post")}),youtubeData)}function fetchData(settings){var context={};return asyncGet(API_URL+"channels?part=statistics%2Csnippet&forUsername="+settings.username+"&key="+settings.api_key).then(function(channels){return context.channel=channels.items[0].snippet,context.statistics=channels.items[0].statistics,context.id=channels.items[0].id,context.username=settings.username,asyncGet(API_URL+"activities?part=snippet%2CcontentDetails&channelId="+context.id+"&maxResults=20&fields=items(contentDetails%2Csnippet)%2CnextPageToken&key="+settings.api_key).then(function(activities){return context.next_page=activities.nextPageToken,context.activities=activities.items.map(function(item){var resource=item.contentDetails[item.snippet.type];return"videoId"in resource?item.snippet.url="https://www.youtube.com/watch?v="+resource.videoId:resource.resourceId.channelId?item.snippet.url="https://www.youtube.com/channel/"+resource.resourceId.channelId:resource.resourceId.videoId&&(item.snippet.url="https://www.youtube.com/watch?v="+resource.resourceId.videoId),item.snippet}),Promise.resolve(context)})})}var DISPLAY_NAME="Youtube",API_URL="https://www.googleapis.com/youtube/v3/";window.youtubeService={displayName:DISPLAY_NAME,template:"youtube.html",setup:setupYoutube,fetch:fetchData}}(window),function(window){function setupGplus(gplusData){return $.each(gplusData.activities,function(i,t){"post"===t.verb?t.verb="posted":"share"===t.verb&&(t.verb="shared"),t.title.length>60&&(t.title=t.title.substr(0,57)+"..."),t.replies=t.object.replies.totalItems,t.plusoners=t.object.plusoners.totalItems,t.resharers=t.object.resharers.totalItems,t.published=moment.utc(t.published,"YYYY-MM-DD HH:mm:ss").fromNow(),t.object.attachments&&t.object.attachments[0].image?t.object.image=t.object.attachments[0].image.url:t.object.content&&(t.object.content=(new DOMParser).parseFromString("<div>"+t.object.content+"</div>","text/xml").documentElement.textContent,t.object.content.length>200&&(t.object.content=t.object.content.substr(0,197)+"..."))}),gplusData}function fetchData(settings){var context={};return Promise.all([asyncGet(API_URL+"people/"+settings.user_id+"?fields=circledByCount%2CcurrentLocation%2CdisplayName%2Cimage%2Furl%2Cnickname%2Coccupation%2CplacesLived%2CplusOneCount%2Ctagline%2Curl&key="+settings.api_key),asyncGet(API_URL+"people/"+settings.user_id+"/activities/public?maxResults=20&fields=items(annotation%2Cobject(actor(displayName%2Curl)%2Cattachments(content%2CdisplayName%2Cimage%2CobjectType%2Cthumbnails)%2Ccontent%2CobjectType%2Cplusoners%2FtotalItems%2Creplies%2FtotalItems%2Cresharers%2FtotalItems%2Curl)%2Cpublished%2Ctitle%2Curl%2Cverb)%2CnextPageToken&key="+settings.api_key)]).then(function(res){return context.newt_page=res[1].nextPageToken,!res[0].currentLocation&&res[0].placesLived&&(res[0].currentLocation=res[0].placesLived[0].value),context.user_info=res[0],context.activities=res[1].items,Promise.resolve(context)})}var DISPLAY_NAME="Google+",API_URL="https://www.googleapis.com/plus/v1/";window.gplusService={displayName:DISPLAY_NAME,template:"gplus.html",setup:setupGplus,fetch:fetchData}}(window),function(window){function setupFacebook(facebookData,settings){return facebookData.url="https://facebook.com/"+settings.username,facebookData.image="imgs/pic.png",facebookData.posts=facebookData.statuses.data.concat(facebookData.links.data),facebookData.posts.sort(function(p1,p2){return(p1.updated_time||p1.created_time)<(p2.updated_time||p2.created_time)}),facebookData.posts.forEach(function(p){p.url=facebookData.url+"/posts/"+p.id,p.updated_time=moment.utc(p.updated_time||p.created_time,"YYYY-MM-DD HH:mm:ss").fromNow(),p.likes=p.likes?p.likes.data.length:0,p.comments=p.comments?p.comments.data.length:0,p.sharedposts=p.sharedposts?p.sharedposts.data.length:0,p.message&&p.message.length>200&&(p.message=p.message.substr(0,197)+"...")}),facebookData}function fetchData(settings){return asyncGet(API_URL+"me?fields=statuses.limit(10){message,updated_time,comments{id},likes{id},sharedposts},links.limit(10){comments{id},likes{id},sharedposts{id},picture,link,name,created_time},id,about,link,name,website,work&method=get&access_token="+settings.access_token).then(function(res){return Promise.resolve(res)})}var DISPLAY_NAME="Facebook",API_URL="https://graph.facebook.com/v2.1/";window.facebookService={displayName:DISPLAY_NAME,template:"facebook.html",setup:setupFacebook,fetch:fetchData}}(window),function(window){function setupLinkedin(linkedinData){return linkedinData.profile.profile_url="http://linkedin.com/profile/view?id="+linkedinData.profile.id,linkedinData.profile.summary=linkedinData.profile.summary.replace("\n","<br />","g"),linkedinData.profile.location_name=linkedinData.profile.location.name,linkedinData}function fetchData(settings){{var profile_selectors=["id","first-name","last-name","headline","location","num-connections","skills","educations","picture-url","summary","positions","industry","site-standard-profile-request"].join();["APPS","CMPY","CONN","JOBS","JGRP","PICT","PFOL","PRFX","RECU","PRFU","SHAR","VIRL"].join("&type=")}return Promise.all([asyncGet(API_URL+"/people/~:("+profile_selectors+")?oauth2_access_token="+settings.access_token)]).then(function(res){return Promise.resolve({profile:res[0]})})}var DISPLAY_NAME="LinkedIn",API_URL="https://api.linkedin.com/v1";window.linkedinService={displayName:DISPLAY_NAME,template:"linkedin.html",setup:setupLinkedin,fetch:fetchData}}(window),function(window){function getPosts(settings,postId,tag,offset){var post_id="",params="";postId?post_id+=postId:tag?params+="?tag="+tag.replace(/\s/g,"-"):settings.tag_slug&&(params+="?tag="+settings.tag_slug.replace(/\s/g,"-")),offset&&nextId&&(params+=(params?"&":"?")+"offset="+nextId);var wpApiUrl=[API_URL,"/sites/",settings.blog_url,"/posts/",post_id,params].join("");return asyncGet(wpApiUrl).then(function(data){return data.error?data={found:0,posts:[]}:postId&&(data={found:1,posts:[data]}),$.each(data.posts,function(i,p){var newTags=[];p.id=p.ID,p.body=p.content,p.content=null,"post"===p.type&&(p.type="text");for(var tag in p.tags)p.tags.hasOwnProperty(tag)&&newTags.push(tag);p.tags=newTags,p.date=p.date.lastIndexOf("+")>0?p.date.substring(0,p.date.lastIndexOf("+")):p.date.substring(0,p.date.lastIndexOf("-"))}),nextId+=20,Promise.resolve(data.posts)})}function fetchPosts(settings){return nextId=0,getPosts(settings,void 0,void 0,!1)}function fetchMorePosts(settings){return getPosts(settings,void 0,void 0,!0)}function fetchOnePost(settings,postId){return nextId=0,getPosts(settings,postId,void 0,!1)}function fetchBlogTag(settings,tag){return nextId=0,getPosts(settings,void 0,tag,!1)}function fetchBlogTagMore(settings,tag){return getPosts(settings,void 0,tag,!0)}var API_URL="https://public-api.wordpress.com/rest/v1",nextId=0;window.wordpressBlog={fetch:fetchPosts,fetchMore:fetchMorePosts,fetchPost:fetchOnePost,fetchTag:fetchBlogTag,fetchTagMore:fetchBlogTagMore}}(window),function(window){function setupContact(data){return data.tel&&(data.tel_uri="tel:+"+data.tel.match(/\((.*)\) (.*)/).slice(1).join("")),data.mobile&&(data.mobile_uri="tel:+"+data.mobile.match(/\((.*)\) (.*)/).slice(1).join("")),data.fax&&(data.fax_uri="fax:+"+data.fax.match(/\((.*)\) (.*)/).slice(1).join("")),data}function fetchContact(settings){var context=[];return settings.pgp_url&&context.push(asyncText(settings.pgp_url)),settings.ssh_url&&context.push(asyncText(settings.ssh_url)),context.length>0?Promise.all(context).then(function(res){var data=settings;return settings.pgp_url?(data.pubkey=res[0],data.sshkey=res[1]):data.sshkey=res[0],Promise.resolve(data)}):Promise.resolve(settings)}var DISPLAY_NAME="Contact";
window.syteupContactService={displayName:DISPLAY_NAME,setup:setupContact,fetch:fetchContact,template:"syteup-contact.html"}}(window);